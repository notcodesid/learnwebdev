{"version":3,"sources":["../../src/server/web-server.ts"],"names":["NextWebServer","BaseServer","constructor","options","handleCatchallRenderRequest","req","res","parsedUrl","pathname","query","Error","normalizedPage","serverOptions","webServerConfig","isDynamicRoute","routeRegex","getNamedRouteRegex","dynamicRouteMatcher","getRouteMatcher","defaultRouteMatches","paramsResult","normalizeDynamicRouteParams","normalizedParams","hasValidParams","params","interpolateDynamicPath","normalizeVercelUrl","Object","keys","routeKeys","removeTrailingSlash","i18nProvider","detectedLocale","analyze","__nextLocale","bubbleNoFallback","_nextBubbleNoFallback","isAPIRoute","render","err","NoFallbackError","assign","renderOpts","extendRenderOpts","getIncrementalCache","requestHeaders","dev","IncrementalCache","requestProtocol","pagesDir","enabledDirectories","pages","appDir","app","allowedRevalidateHeaderKeys","nextConfig","experimental","minimalMode","fetchCache","fetchCacheKeyPrefix","maxMemoryCacheSize","cacheMaxMemorySize","flushToDisk","CurCacheHandler","incrementalCacheHandler","getPrerenderManifest","ppr","getResponseCache","WebResponseCache","hasPage","page","getBuildId","buildId","getEnabledDirectories","pagesType","getPagesManifest","getAppPathsManifest","attachRequestMeta","addRequestMeta","prerenderManifest","version","routes","dynamicRoutes","notFoundRoutes","preview","previewModeId","getNextFontManifest","nextFontManifest","renderHTML","renderToHTML","UNDERSCORE_NOT_FOUND_ROUTE","disableOptimizedLoading","runtime","sendRenderResult","_req","setHeader","poweredByHeader","type","getHeader","result","contentType","promise","isDynamic","pipeTo","transformStream","writable","payload","toUnchunkedString","String","byteLength","generateEtags","generateETag","body","send","findPageComponents","url","_url","loadComponent","components","runApi","handleApiRequest","loadEnvConfig","getPublicDir","getHasStaticDir","getFallback","getFontManifest","undefined","handleCompression","handleUpgrade","getFallbackErrorComponents","getRoutesManifest","getMiddleware","getFilesystemPaths","Set","getPrefetchRsc","getinterceptionRoutePatterns","interceptionRouteRewrites","map","rewrite","RegExp","buildCustomRoute","regex"],"mappings":"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"}